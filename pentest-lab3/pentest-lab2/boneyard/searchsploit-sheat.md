  
 with Searchsploit

The Searchsploit tool is built-in to Kali Linux. It is designed to search the local exploit database. This tool becomes handy when you do not have Internet connectivity and need to search for exploits. However, if the exploit database is not updated, you may not get the exploit information that you searched for. You can perform a search based on title and even examine an exploit.

In this task, you will learn to work with Searchsploit. To do this, perform the following steps:
Step 1

Ensure that you are connected to PLABKALI01. Open the terminal window.

Figure 1.60 Screenshot of PLABKALI01
Figure 1.60 Screenshot of PLABKALI01: Showing the Kali prompt in the terminal window.

Step 2

Before running the searchsploit tool, let’s update it first. To do this, type the following command:

searchsploit -u

Press Enter.
Note: This update may take a few minutes to complete.

Figure 1.61 Screenshot of PLABKALI01
Figure 1.61 Screenshot of PLABKALI01: Entering the searchsploit command to update itself.

Step 3

In the end, you are prompted with a message that the Git update has finished.

Figure 1.62 Screenshot of PLABKALI01
Figure 1.62 Screenshot of PLABKALI01: Showing the output of the run searchsploit -u command.

Step 4

Clear the screen with the clear command.

You can now start using the searchsploit tool. Let’s first run a simple query to find out information about an exploit named MS17-010. Type the following command:

searchsploit MS17-010

Press Enter.

Figure 1.63 Screenshot of PLABKALI01
Figure 1.63 Screenshot of PLABKALI01: Entering the searchsploit command to search for a specific exploit.

Step 5

The details of the MS17-010 exploit is now displayed.

Figure 1.64 Screenshot of PLABKALI01
Figure 1.64 Screenshot of PLABKALI01: Showing the output of the searchsploit command with the information about the exploit.

Step 6

You may want to find remote Windows vulnerabilities. To find these vulnerabilities, you need to search for keywords like Windows and remote. Type the following command:

searchsploit -t windows remote

Press Enter.
Note: The -t parameter is used for the term, which in this case are Windows and remote.

Figure 1.65 Screenshot of PLABKALI01
Figure 1.65 Screenshot of PLABKALI01: Entering the searchsploit command to search for more than one exploit.

Step 7

The result of the search with keywords Windows and remote are now displayed.

Figure 1.66 Screenshot of PLABKALI01
Figure 1.66 Screenshot of PLABKALI01: Showing the output of the searchsploit command with the list of exploits.

Step 8

Clear the screen with the clear command.

You can copy the exploit to a directory, which by default will be /root. To copy an exploit to /root, type the following command:

searchsploit -m 39166

Press Enter.
Note: If you use the -p parameter, then the path for the exploit will be copied to the clipboard.

Figure 1.67 Screenshot of PLABKALI01
Figure 1.67 Screenshot of PLABKALI01: Entering the searchsploit command to copy the exploit to the root directory.

Step 9

The exploit has been copied to the /root directory.

Figure 1.68 Screenshot of PLABKALI01
Figure 1.68 Screenshot of PLABKALI01: Showing the copied exploit in the root directory.

Step 10

You can verify if the exploit has been copied to the /root directory. Type the following command:

ls -l /root

Press Enter.

Figure 1.69 Screenshot of PLABKALI01
Figure 1.69 Screenshot of PLABKALI01: Entering the ls -l command to list the files in the root directory.

Step 11

Notice that 39166.c is listed in the /root directory.

Figure 1.70 Screenshot of PLABKALI01
Figure 1.70 Screenshot of PLABKALI01: Showing the copied exploit in the root directory.

Step 12

Clear the screen with the clear command.

You can also examine an exploit to understand its functionality. To do this, type the following command:

searchsploit 39166 --examine

Press Enter.

Figure 1.71 Screenshot of PLABKALI01
Figure 1.71 Screenshot of PLABKALI01: Entering the searchsploit command with the examine parameter to understand an exploits functionality.

Step 13

The exploit information spread across multiple pages. You can press the PgDn key to continue reading.

Figure 1.72 Screenshot of PLABKALI01
Figure 1.72 Screenshot of PLABKALI01: Showing the information about a specific exploit.

Step 14

When you are done the reading, press Ctrl + z key to abort the command. You are now back at the prompt.

Figure 1.73 Screenshot of PLABKALI01
Figure 1.73 Screenshot of PLABKALI01: Pressing the Ctrl + z keys to abort the searchsploit command.

Step 15

Clear the screen with the clear command.

You can also get the updated information about the exploit from the exploit-db.com Website. You need to use the -w parameter for this purpose. Type the following command:

searchsploit Windows iis -w

Press Enter.

Figure 1.74 Screenshot of PLABKALI01
Figure 1.74 Screenshot of PLABKALI01: Entering the command to retrieve the latest information about a specific type of exploit from the www.exploit-db.com Website.

Step 16

Information about several exploits is now listed.

Figure 1.75 Screenshot of PLABKALI01
Figure 1.75 Screenshot of PLABKALI01: Showing the information from the www . exploit - db . com Website.

Step 17

Clear the screen with the clear command.

When you are searching for the exploit database, there will be chances that you get unwanted results. You can remove them using the - -exclude parameter. Type the following command:

searchsploit --exclude=Windows

Press Enter.

Figure 1.76 Screenshot of PLABKALI01
Figure 1.76 Screenshot of PLABKALI01: Entering the searchsploit command to exclude a specific type of exploits.

Step 18

The output of this command is displayed.

Figure 1.77 Screenshot of PLABKALI01
Figure 1.77 Screenshot of PLABKALI01: Showing the output of a searchsploit command with the - - exclude parameter.

Step 19

Clear the screen with the clear command.

You can also combine the searchsploit command along with the grep command. This will help you further narrow down the results. Type the following:

searchsploit windows | grep “Privilege Escalation”

Press Enter.

Figure 1.78 Screenshot of PLABKALI01
Figure 1.78 Screenshot of PLABKALI01: Entering the searchsploit command with the grep command to limit the search results.

Step 20

Notice that the output has now narrowed down.

Figure 1.79 Screenshot of PLABKALI01
Figure 1.79 Screenshot of PLABKALI01: Showing the output of the searchsploit command with the grep command with the limited search results.

Step 21

You can also perform a case-sensitive search using the -c parameter. Type the following command:

searchsploit -c XSS

Press Enter.

Figure 1.80 Screenshot of PLABKALI01
Figure 1.80 Screenshot of PLABKALI01: Entering the searchsploit command with the -c parameter to search for case sensitive information.

Step 22

Notice that only the results matching the case are displayed.

Figure 1.81 Screenshot of PLABKALI01
Figure 1.81 Screenshot of PLABKALI01: Showing the output of the searchsploit command with the -c parameter.

