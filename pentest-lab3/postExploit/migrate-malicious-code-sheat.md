 # this is how to get a malicious code onto a windows system.


''

Migrate Malicious Code to an Exploited Windows Host

After you have exploited a Windows host, you can migrate the malicious code to it. This code needs to be transferred from a Meterpreter session to a running process, such as explorer.exe.

In this task, you will migrate malicious code to an exploited Windows host. To do this, perform the following steps:
Step 1

Ensure that you are connected to PLABKALI01, and Meterpreter session is open.

You need first to get the process ID (PID) of the current session that is running to do this, type the following command:

getpid

Press Enter.

Figure 1.18 Screenshot of PLABKALI01
Figure 1.18 Screenshot of PLABKALI01: Entering the getpid command.

Step 2

The output of the getpid command is displayed. Make a note of the PID. You will require this in the next steps.
Note: The output of the getpid command will differ in your environment.

Figure 1.19 Screenshot of PLABKALI01
Figure 1.19 Screenshot of PLABKALI01: Showing the result of the getpid command.
  

Step 3

Next, letâ€™s list the running processes on the exploited Windows system. Type the following command:

ps

Press Enter.

Figure 1.20 Screenshot of PLABKALI01
Figure 1.20 Screenshot of PLABKALI01: Entering the ps command.

Step 4

The list of running processes is displayed. The PID for explorer.exe is 2852. Its parent PID is 2828.
Note: These PIDs will differ in your lab environment.

Figure 1.21 Screenshot of PLABKALI01
Figure 1.21 Screenshot of PLABKALI01: Showing the output of the ps command.

Step 5

You, now, need to migrate malicious code into explorer.exe. To do this, type the following command:

migrate 2852

Note: Use the same PID that appears in the previous output with the migrate command.

Press Enter.

Figure 1.22 Screenshot of PLABKALI01
Figure 1.22 Screenshot of PLABKALI01: Entering the migrate command to migrate malicious code to explorer.exe.

Step 6

Note that malicious code has been transferred successfully.

Figure 1.23 Screenshot of PLABKALI01
Figure 1.23 Screenshot of PLABKALI01: Showing the output of the migrate command.

Step 7

You will now verify that the session PID has changed to the PID of explorer.exe. To do this, type the following command:

getpid

Press Enter.

Figure 1.24 Screenshot of PLABKALI01
Figure 1.24 Screenshot of PLABKALI01: Entering the getpid command to get the PID of the session.

Step 8

The output of the getpid command is displayed. The PID of this session and explorer.exe is now the same.

''


