
Course list
Content
Devices
First device window

Access your Practice Lab titles
Access your exercise content
Reports and files
Access your settings

    Access help and support

CompTIA PenTest+
Conducting Active Reconnaissance for Vulnerabilities in a Network
Exercise 1- Conducting Active Reconnaissance in a Network
Exercise 1- Conducting Active Reconnaissance in a Network

Penetration Testing, or Pentest, is a simulated cyber-attack to exploit the vulnerabilities in a network and the systems. It locates the vulnerabilities and then attempts to exploit them. A person conducting the pentest can attempt a breach of applications, protocols, Application Programming Interfaces (APIs), servers, firewalls, and anything that can be exploited on a network. The core intent is to discover the vulnerabilities before an attacker from the outside world can and then exploit them to simulate the amount of damage that can be caused.

In this exercise, you will learn about Penetration Testing and its importance.
Alert
The tools and techniques displayed in these exercises are to be used for improving network security. Usage of all tools for attacking targets without prior mutual consent is illegal. Practice Labs assumes no liability for any misuse or damage caused if these tools and techniques are used for malicious activities.
Learning Outcomes

After completing this exercise, you will be able to:

    Identify Live Hosts on a Network
    Perform Discovery Scans
    Perform Port Scanning
    Perform Stealth Scans
    Perform Packet Crafting
    Perform Fingerprinting
    Perform Service Probing
    Disable Ping Sweep
    Use Timing Templates
    Work with Nmap Output Parameters, such as oA, oN, oG, and oX

Your Devices

You will be using the following devices in this lab. Please power these on now.

    PLABDC01 - (Windows Server 2019 - Domain Server)
    PLABDM01 - (Windows Server 2019 - Domain Controller)
    PLABKALI01 - (Kali 2019.2 - Linux Kali)
    PLABWIN10 - (Windows 10 - Domain Member)
    PLABWIN810 - (Windows 8.1 - Domain Member)

Practice Labs screenshot.
Task 1 - Identify Live Hosts on a Network

Network Mapper, more commonly known as Nmap, is a network and host discovery tool. It is one of the most widely used tools for various activities, such as:

    Discovering hosts, services, and ports
    Fingerprinting operating system
    Enumeration
    Discovering vulnerabilities on the local and remote host
    Find the IP address of a remote system

Using Nmap, you can scan for targets in the following way:

    Scan for a single IP: nmap 192.168.0.1
    Scan for a host by using its name: nmap host1.plab.com
    Scan an entire subnet: nmap plab.com/24, nmap 192.168.0.0/24, nmap 192.168.0.*
    Scan for a range of IP addresses: nmap 192.168.0.1-10
    Scan for a range and a system outside the range: nmap 192.168.0.1, 1.10

In this task, you will use Nmap to identify the live systems on a network. To do this, perform the following steps:
Step 1

Ensure you have powered on all the devices listed in the introduction, and connect to PLABKALI01.

Note that the Kali desktop is displayed.

On the desktop, click Terminal.

Figure 1.1 Screenshot of PLABKALI01
Figure 1.1 Screenshot of PLABKALI01: Clicking the Terminal icon in the left pane.

Step 2

The terminal window is displayed. You will now perform a ping scan to discover the live hosts in a network. Type the following command:
Note: the -sP parameter is used for ping scanning. When you use CIDR /24, Nmap will scan all 256 IP addresses on the network.

nmap -sP 192.168.0.0/24

Press Enter.

Figure 1.2 Screenshot of PLABKALI01
Figure 1.2 Screenshot of PLABKALI01: Typing the nmap command with the -sP parameter in the terminal window.

Step 3

The output of the above command is displayed. Notice that there were eight hosts that were detected. Along with this, the gateway IP, 192.168.0.250, is also found.

Figure 1.3 Screenshot of PLABKALI01
Figure 1.3 Screenshot of PLABKALI01: Showing the output of the nmap -sP command.

Step 4

Clear the screen by entering the following command:

clear

You can also perform a scan without ping. To do this, type the following command:

nmap -sn 192.168.0.0/24

Press Enter.

Figure 1.4 Screenshot of PLABKALI01
Figure 1.4 Screenshot of PLABKALI01: Typing the nmap -sn command in the terminal window.

Step 5

The output of the following command is displayed. Notice that without the ping scan, it has detected eight systems on the network.

Figure 1.5 Screenshot of PLABKALI01
Figure 1.5 Screenshot of PLABKALI01: Showing the output of the nmap -sn command.

Step 6

Clear the screen by entering the following command:

clear

You can also trace the path between your system and each of the host that is live on the network. To do this, type the following command:

nmap --traceroute 192.168.0.0/24

Press Enter.

Figure 1.6 Screenshot of PLABKALI01
Figure 1.6 Screenshot of PLABKALI01: Typing the nmap --traceroute command in the terminal window.

Step 7

Notice the output of the command. In the output, the hops from your system to the systems on the network are displayed. Since this is within the same IP subnet, there is a single hop. The output also displays open ports on each live system.

Figure 1.7 Screenshot of PLABKALI01
Figure 1.7 Screenshot of PLABKALI01: Showing the output of the nmap - - traceroute command.

Step 8

Clear the screen by entering the following command:

clear

You can also scan for live hosts on a network using an IP address range. To do this, type the following command:

nmap 192.168.0.1-6

Press Enter.

Figure 1.8 Screenshot of PLABKALI01
Figure 1.8 Screenshot of PLABKALI01: Typing the nmap command with a series of IP addresses in the terminal window.

Step 9

The output of the following command is displayed. Notice that only six hosts are listed in the scan. Without any parameters, the nmap command scans for the live systems and open ports.

Figure 1.9 Screenshot of PLABKALI01
Figure 1.9 Screenshot of PLABKALI01: Showing the output of the nmap command with a series of IP addresses.

Step 10

Clear the screen by entering the following command:

clear

You can also use a wildcard to scan an IP range. To do this, type the following command:

nmap 192.168.0.*

Press Enter.

Figure 1.10 Screenshot of PLABKALI01
Figure 1.10 Screenshot of PLABKALI01: Typing the nmap command with a wildcard in the terminal window.

Step 11

Notice the output of the nmap command with the asterisk. It has searched for all live systems in the subnet of 256 IP addresses.

Figure 1.11 Screenshot of PLABKALI01
Figure 1.11 Screenshot of PLABKALI01: Showing the output of the nmap command with a wildcard.

Keep the terminal window open.
Task 2 - Perform Discovery Scans

Discovery scan is used for locating live hosts on a network. There are various methods that can be used in discovery scans. Some of these are:

    Using ping scan
    Using ARP scan
    Using a port scan

In this task, you will learn to perform different types of discovery scans. To do this, perform the following steps:
Step 1

Ensure that you are connected to Kali Linux and the terminal window is open.

Clear the screen by entering the following command:

clear

Using ping for discovering a host is a common method. Type the following command:
Note: Several systems have firewalls running that block ping commands, and therefore, discovering a host using ping may not be successful.

nmap -sP 192.168.0.0/24

Press Enter.

Figure 1.12 Screenshot of PLABKALI01
Figure 1.12 Screenshot of PLABKALI01: Typing the nmap -sP command in the terminal window.

Step 2

Notice the output of the command. When you execute this command, it sends ICMP REQUEST message to every IP address. The hosts that respond to the ICMP REQUEST message are considered alive and are listed in the output. This command does not list the hosts that do not respond.

Figure 1.13 Screenshot of PLABKALI01
Figure 1.13 Screenshot of PLABKALI01: Showing the output of the nmap -sP command.

Step 3

Clear the screen by entering the following command:

clear

You can also send the ARP requests to the hosts on a given subnet, and if the target system responds to the ARP requests, then it means that it is alive. This method, unlike the Ping scan method, is not blocked by the firewall in most cases. Therefore, you are likely to get a better outcome. To send the ARP requests to the 192.168.0.0/24 subnet, type the following command:

nmap -PR 192.168.0.0/24

Press Enter.

Figure 1.14 Screenshot of PLABKALI01
Figure 1.14 Screenshot of PLABKALI01: Typing the nmap -PR command in the terminal window.

Step 4

Notice the outcome of this command. With the -PR parameter, the nmap command has scanned 256 IP addresses and found eight hosts live. Notice that open ports are also listed.
Note: You can scan for the live hosts without detecting the open ports. To do this, you can use the following command: nmap -sn 192.168.0.0/24.

Figure 1.15 Screenshot of PLABKALI01
Figure 1.15 Screenshot of PLABKALI01: Showing the output of the nmap -PR command.

Step 5

Clear the screen by entering the following command:

clear

You can also scan for open ports to detect the system status. This could be useful when these systems have firewalls enabled, or the systems are in another subnet or network. When you attempt to detect the ports, the systems will respond to the request. Type the following command:

nmap -p 80 192.168.0.0/24

Press Enter.

Figure 1.16 Screenshot of PLABKALI01
Figure 1.16 Screenshot of PLABKALI01: Typing the nmap -p command in the terminal window.

Step 6

The output of this command is displayed. Notice that eight hosts are scanned, but one host, 192.168.0.3, is running a Web server.
Note: With the -p parameter, you can scan for more than one port. For example, you can use the following command: nmap -p 22, 23, 80, 139, 445, 3389 192.168.0.0/24. Each port number needs to be separated by a comma.

Figure 1.17 Screenshot of PLABKALI01
Figure 1.17 Screenshot of PLABKALI01: Showing the output of the nmap -p command.

Step 7

You can also send the SYN message to a specific port on a subnet to detect live systems. To do this, type the following command:

nmap -sn -PS80 192.168.0.0/24

Press Enter.

Figure 1.18 Screenshot of PLABKALI01
Figure 1.18 Screenshot of PLABKALI01: Typing the nmap -sn -PS80 command in the terminal window.

Step 8

The output of this command is displayed. Notice that eight hosts were found to be live in this subnet.

Figure 1.19 Screenshot of PLABKALI01
Figure 1.19 Screenshot of PLABKALI01: Showing the output of the nmap -sn -PS80 command.

Keep the terminal window open.
Task 3 - Perform Port Scanning

Using the port scan method, you can determine the TCP or UDP port that is being used. You can either scan for the entire range of ports, which are from 1 to 65535, or can scan for specific ports. When scanning for ports, you need to be aware that there can be different states of a port:

    Open: An application is listening for connections on this port.
    Closed: The messages were received, but no application is listening on the port.
    Filtered: The messages were not received, and the state of the port could not be determined. This state occurs when some type of filtering is being used on the port.
    Unfiltered: The messages are received, but still, the state of the port could not be determined.
    Open/Filtered: The port was either filtered or open, but Nmap was not able to determine the state.
    Closed/Filtered: The port was either filtered or closed, but Nmap was not able to determine the state.

To use port scanning, perform the following steps:
Step 1

Ensure that you are connected to Kali Linux and the terminal window is open.

Clear the screen by entering the following command:

clear

One of the simplest methods is to target a system with the nmap command without using any parameters.

nmap 192.168.0.5

Press Enter.

Figure 1.20 Screenshot of PLABKALI01
Figure 1.20 Screenshot of PLABKALI01: Typing the nmap command with a single host in the terminal window.

Step 2

The output of this command is displayed. Notice that 192.168.0.5 has only one port open, which is 3389.

Figure 1.21 Screenshot of PLABKALI01
Figure 1.21 Screenshot of PLABKALI01: Showing the output of the nmap command.

Step 3

You can scan for a single port on a host. To do this, type the following command:

nmap -p 22 192.168.0.1

Press Enter.

Figure 1.22 Screenshot of PLABKALI01
Figure 1.22 Screenshot of PLABKALI01: Typing the nmap -p 22 command in the terminal window.

Step 4

The output of this command is displayed. Notice that the state of the port is set to filtered.

Figure 1.23 Screenshot of PLABKALI01
Figure 1.23 Screenshot of PLABKALI01: Showing the output of the nmap -p 22 command.

Step 5

Let’s try to scan for the range of ports on 192.168.0.1, which is the domain controller. To do this, type the following command:

nmap -p 1-100 192.168.0.1

Press Enter.

Figure 1.24 Screenshot of PLABKALI01
Figure 1.24 Screenshot of PLABKALI01: Typing the nmap -p 1-100 command in the terminal window.

Step 6

Notice that the command has executed successfully. The output displays that there are 98 filtered ports and two open ports, which are 53 and 88.

Figure 1.25 Screenshot of PLABKALI01
Figure 1.25 Screenshot of PLABKALI01: Showing the output of the nmap -p 1-100 command.

Step 7

Clear the screen by entering the following command:

clear

Let’s now try fast scan, which will scan for the 100 common ports on a given system. To do this, type the following command:

nmap -F 192.168.0.1

Press Enter.

Figure 1.26 Screenshot of PLABKALI01
Figure 1.26 Screenshot of PLABKALI01: Typing the nmap -F command in the terminal window.

Step 8

The output of this command is displayed. Notice that the output of this command is different than the previous command. It shows 92 filtered ports and 8 open ports. The output is different because the fast scan uses the 100 most common ports.

Figure 1.27 Screenshot of PLABKALI01
Figure 1.27 Screenshot of PLABKALI01: Showing the output of the nmap -F command.

Step 9

Clear the screen by entering the following command:

clear

You will now scan for 65535 ports on a system. To do this, type the following command:

nmap -p- 192.168.0.1

Press Enter.
Note: This command will take a while to generate the output. Remember, it is scanning for 65535 ports on a system.

Figure 1.28 Screenshot of PLABKALI01
Figure 1.28 Screenshot of PLABKALI01: Typing the nmap -p- command in the terminal window.

Step 10

The output of this command is displayed. Note that it took nearly two minutes to generate the output and found several ports open on the domain controller, which is 192.168.0.1.

Figure 1.29 Screenshot of PLABKALI01
Figure 1.29 Screenshot of PLABKALI01: Showing the output of the nmap -p- command.

Step 11

Next, you will perform port scanning using TCP connect. Type the following command:

nmap -sT 192.168.0.1

Press Enter.

Figure 1.30 Screenshot of PLABKALI01
Figure 1.30 Screenshot of PLABKALI01: Typing the nmap -sT command in the terminal window.

Step 12

Notice the output. This command has scanned 1000 ports. There are 987 filtered and 13 open ports.

Figure 1.31 Screenshot of PLABKALI01
Figure 1.31 Screenshot of PLABKALI01: Showing the output of the nmap -sT command.

Step 13

Clear the screen by entering the following command:

clear

Let’s scan for the selective UDP ports only. Type the following command:

nmap -sU -p 123,161,162 192.168.0.1

Press Enter.
Note: Do not provide space after the comma when listing the ports. Else, Nmap considers it to be the IP address and will attempt to find the route to the port number.

Figure 1.32 Screenshot of PLABKALI01
Figure 1.32 Screenshot of PLABKALI01: Typing the nmap -sU command in the terminal window.

Step 14

The output of this command is displayed. Notice that only NTP port, 123, is open. The remaining two ports are filtered.

Figure 1.33 Screenshot of PLABKALI01
Figure 1.33 Screenshot of PLABKALI01: Showing the output of the nmap -sU command.

Step 15

Clear the screen by entering the following command:

clear

You can also use the - - top-ports parameter with a specified number to find ports. To do this, type the following command:

nmap --top-ports 10 192.168.0.1

Press Enter.

Figure 1.34 Screenshot of PLABKALI01
Figure 1.34 Screenshot of PLABKALI01: Typing the nmap -top-ports command in the terminal window.

Step 16

Notice that the top 10 used ports are listed as the output with their current state.

Figure 1.35 Screenshot of PLABKALI01
Figure 1.35 Screenshot of PLABKALI01: Showing the output of the nmap -top-ports command.

Keep the terminal window open.
Task 4 - Perform Stealth Scanning

Ìn a stealth scan, the attacker, does not complete the three-way handshake with the victim’s system and, therefore, goes undetected. Nmap has different options for conducting stealth scans, which you will perform in this task.

To conduct stealth scanning, perform the following steps:
Step 1

Ensure that you are connected to Kali Linux and the terminal window is open.

Clear the screen by entering the following command:

clear

You will now scan for the ports using a TCP SYN scan, which is known to be a stealth scan. Type the following command:

nmap -sS 192.168.0.1

Press Enter.

Figure 1.36 Screenshot of PLABKALI01
Figure 1.36 Screenshot of PLABKALI01: Typing the nmap -sS command in the terminal window.

Step 2

Notice that the output which lists the open ports on 192.168.0.1.

Figure 1.37 Screenshot of PLABKALI01
Figure 1.37 Screenshot of PLABKALI01: Showing the output of the -sS command.

Step 3

Clear the screen by entering the following command:

clear

You can also perform a TCP ACK scan, which does not return the list of open or closed ports. The open and closed ports on a system return the RST packet back as a response to the ACK packet that was sent to them. These ports are then labeled as unfiltered. Ports that do not respond back are labeled as filtered.

To perform a TCP ACK scan, type the following command:

nmap -sA 192.168.0.0/24

Press Enter.

Figure 1.38 Screenshot of PLABKALI01
Figure 1.38 Screenshot of PLABKALI01: Typing the nmap -sA command in the terminal window.

Step 4

The output of this command is displayed. The output does not contain the open or closed ports but filtered or unfiltered ports. For example, all 1000 ports on 192.168.0.5 are filtered, whereas, on 192.168.0.3, they are unfiltered.

Figure 1.39 Screenshot of PLABKALI01
Figure 1.39 Screenshot of PLABKALI01: Showing the output of the nmap -sA command.

Step 5

Clear the screen by entering the following command:

clear

You can also perform a stealth scan to avoid being detected by the non-stateful firewalls. This is known as Null scan. In this type of scan, the TCP segment does not carry a flag. In the usual state, there would be at least the ACK flag that is raised. To perform this type the following command:

nmap -sN 192.168.0.1-6

Press Enter.

Figure 1.40 Screenshot of PLABKALI01
Figure 1.40 Screenshot of PLABKALI01: Typing the nmap -sN command in the terminal window.

Step 6

The output of this command is displayed. It lists the open and filtered ports on various target systems.

Figure 1.41 Screenshot of PLABKALI01
Figure 1.41 Screenshot of PLABKALI01: Showing the output of the nmap -sN command.

Step 7

Clear the screen by entering the following command:

clear

Another type of stealth scan is FIN scan, which sends a TCP FIN message. To conduct a FIN scan, type the following command:

nmap -sF 192.168.0.1-6

Press Enter.

Figure 1.42 Screenshot of PLABKALI01
Figure 1.42 Screenshot of PLABKALI01: Typing the nmap -sF command in the terminal window.

Step 8

The output of this command is displayed.

Figure 1.43 Screenshot of PLABKALI01
Figure 1.43 Screenshot of PLABKALI01: Showing the output of the nmap -sF command.

Step 9

Clear the screen by entering the following command:

clear

The next type of stealth scan is Xmas scan, which sends the TCP segment with three flags raised. These flags are FIN, PSH, and URG.
Note: The Null, FIN, and Xmas scans are used to avoid being detected by the non-stateful firewall.

To perform the Xmas scan, type the following command:

nmap -sX 192.168.0.1-3

Press Enter.

Figure 1.44 Screenshot of PLABKALI01
Figure 1.44 Screenshot of PLABKALI01: Typing the nmap -sX command in the terminal window.

Step 10

Notice the outcome of this command.

Figure 1.45 Screenshot of PLABKALI01
Figure 1.45 Screenshot of PLABKALI01: Showing the output of the nmap -sX command.

Step 11

Clear the screen by entering the following command:

clear

You can also choose the speed of your stealth scan. For example, you choose paranoid, sneaky, polite, normal, aggressive, and insane. These are defined as T0 to T5, where T5 is the fastest. Let’s perform a T5 scan on a system. Type the following command:

nmap 192.168.0.5 -T 5

Press Enter.

Figure 1.46 Screenshot of PLABKALI01
Figure 1.46 Screenshot of PLABKALI01: Typing the nmap command with the -T5 parameter in the terminal window.

Step 12

Notice the speed of the scan.
Note: You should attempt to perform a T1 or T2 scan and notice the timing difference.

Figure 1.47 Screenshot of PLABKALI01
Figure 1.47 Screenshot of PLABKALI01: Showing the output of the nmap command with the -T parameter.

Keep the terminal window open.
Task 5 - Perform Packet Crafting

Packet crafting is a method to craft a network packet in a specific manner. Packet crafting has been widely used for testing the firewalls, whether they allow the crafted packets or simply block them. Hping3 is a tool that is used for packet crafting.

There are four stages in packet crafting:

    Packet Assembly: A packet is fabricated to be sent.
    Packet Editing: The fabricated packet is tested and tuned if required.
    Packet Playing: After the packet editing phase, the packet is sent to the network.
    Packet Analysis: The attacker uses a packet sniffing tool, such as Wireshark, to capture and analyze the packets.

To conduct packet crafting, perform the following steps:
Step 1

Ensure that you are connected to Kali Linux and the terminal window is open.

Clear the screen by entering the following command:

clear

Let’s attempt at packet crafting. Type the following command:
Note: The command contains the following: -F: Sets the TCP FIN flag, -c: Sets the packet count, -p: Sets the destination port, -s: Sets the source port

hping3 -F -c 1 -p 80 -s 5150 192.168.0.6

Press Enter.

Figure 1.48 Screenshot of PLABKALI01
Figure 1.48 Screenshot of PLABKALI01: Typing the hping3 command with various parameters in the terminal window.

Step 2

The output of this command is displayed. In the output, the target responds with the RST-ACK response. Notice the RA value in the flags field.

Figure 1.49 Screenshot of PLABKALI01
Figure 1.49 Screenshot of PLABKALI01: Showing the output of the hping3 command.

Step 3

Let’s send an identical packet but with the SYN flag. Type the following command:
Note: -S sets the SYN flag in the TCP header.

hping3 -S -c 1 -p 80 -s 5150 192.168.0.6

Press Enter.

Figure 1.50 Screenshot of PLABKALI01
Figure 1.50 Screenshot of PLABKALI01: Typing the hping3 command with the SYN flag in the terminal window.

Step 4

Notice that the output is similar to the FIN flag.

Figure 1.51 Screenshot of PLABKALI01
Figure 1.51 Screenshot of PLABKALI01: Showing the output of the hping3 command with the SYN flag.

Keep the terminal window open.
Task 6 - Fingerprinting an Operating System

Operating system fingerprinting is also known as banner grabbing. With the help of fingerprinting, you can determine the type of operating system and its version on a remote system. There are primarily two types of fingerprinting:

Active:

Nmap contains a list of the operating system. When you execute a command to determine the operating system of a remote host, packets are sent to the remote host, and the response is received, which is compared with the list of operating systems. Nmap then provides the closest match.

Passive:

Passive fingerprinting can be done in different ways. For example, you can get a lot of details from the error messages, which can contain information, such as the type of operating system and server. Sniffing network traffic can also be helpful in determining the operating system.

To fingerprint a system, perform the following steps:
Step 1

Ensure that you are connected to Kali Linux and the terminal window is open.

Clear the screen by entering the following command:

clear

To fingerprint a remote system, type the following command:

nmap -O 192.168.0.6

Press Enter.

Figure 1.52 Screenshot of PLABKALI01
Figure 1.52 Screenshot of PLABKALI01: Typing the nmap -O command in the terminal window.

Step 2

Notice that the operating system and its version are detected.

Figure 1.53 Screenshot of PLABKALI01
Figure 1.53 Screenshot of PLABKALI01: Showing the output of the nmap -O command.

Step 3

Clear the screen by entering the following command:

clear

The -O parameter provides more options for operating system detection. You can choose to skip the hosts that are not up and running and scan for the operating system only on the live hosts. To do this, type the following command:

nmap -O --osscan-limit 192.168.0.0/24

Press Enter.

Figure 1.54 Screenshot of PLABKALI01
Figure 1.54 Screenshot of PLABKALI01: Typing the nmap -O command in the terminal window.

Step 4

Notice the output for 192.168.0.3. Operating system detection has been performed only on the live hosts.

Figure 1.55Screenshot of PLABKALI01
Figure 1.55Screenshot of PLABKALI01: Showing the output of the nmap -O command.

Step 5

Clear the screen by entering the following command:

clear

You can also use --osscan-guess option with the -O parameter. It will attempt to detect the operating system. If it is not able to do so, then it will provide the closest signature possible. It performs an aggressive detection of the operating system. To do this, type the following command:

nmap -O -osscan-guess 192.168.0.3

Press Enter.

Figure 1.56 Screenshot of PLABKALI01
Figure 1.56 Screenshot of PLABKALI01: Typing the nmap -O command in the terminal window.

Step 6

Notice that the operating system and its version has been detected successfully.

Figure 1.57 Screenshot of PLABKALI01
Figure 1.57 Screenshot of PLABKALI01: Showing the output of the nmap -O command.

Step 7

When you perform an operating system scan, Nmap, by default, attempts five times to detect the name and version. However, to speed up the process, you can limit the number of attempts. To do this, type the following command:

nmap -O --max-os-tries 2 192.168.0.5

Press Enter.

Figure 1.58 Screenshot of PLABKALI01
Figure 1.58 Screenshot of PLABKALI01: Typing the nmap -O command in the terminal window.

Step 8

Notice the output. The 192.168.0.5 is a Windows 8.1 system. However, Nmap has only been able to detect it to the closest version, which is Windows Vista SP2 or Windows Server 2008.

Figure 1.59 Screenshot of PLABKALI01
Figure 1.59 Screenshot of PLABKALI01: Showing the output of the nmap -O command.

Step 9

You can also use the -A parameter with the nmap command to perform fingerprinting. To do this, type the following command:

nmap -A 192.168.0.6

Press Enter.

Figure 1.60 Screenshot of PLABKALI01
Figure 1.60 Screenshot of PLABKALI01: Typing the nmap -A command in the terminal window.

Step 10

The operating system has been detected.

Figure 1.61 Screenshot of PLABKALI01
Figure 1.61 Screenshot of PLABKALI01: Showing the output of the nmap -A command.

Step 11

Clear the screen by entering the following command:

clear

Other than Nmap, you can also use another tool named p0f for operating system fingerprinting. It is a good tool to find out the operating system of a Website. To use the p0f tool, type the following command:
Note: You can use the p0f command with the -i <interface_name> to use a specific interface on your system. For example, you can use eth0 -i eth0.

p0f

Press Enter.

Figure 1.62 Screenshot of PLABKALI01
Figure 1.62 Screenshot of PLABKALI01: Typing the p0f command in the terminal window.

Step 12

Notice that the p0f tool has started but is not doing anything. It has 322 signatures that are kept in the /etc/p0f/p0f.fp file. It also mentions that it is using the eth0 interface.

Figure 1.63 Screenshot of PLABKALI01
Figure 1.63 Screenshot of PLABKALI01: Showing the start of the p0f command.

Step 13

Minimize the terminal window and click the Firefox icon to launch the browser window.

Figure 1.64 Screenshot of PLABKALI01
Figure 1.64 Screenshot of PLABKALI01: Clicking the Firefox icon in the left pane on the desktop.

Step 14

Notice that the default intranet Website is loaded. Minimize the Firefox window.

Figure 1.65 Screenshot of PLABKALI01
Figure 1.65 Screenshot of PLABKALI01: Showing the Intranet Webpage.
  

Step 15

Notice that p0f has started to capture a lot of data. Press Ctrl + C to stop the p0f tool. It has captured quite a bit of information. The operating system is Linux, and the Website was viewed on Firefox 60.0.

Figure 1.66 Screenshot of PLABKALI01
Figure 1.66 Screenshot of PLABKALI01: Stopping the p0f command.

Step 16

Scroll up and notice that the server on which the Website is hosted has also been detected.

Figure 1.67 Screenshot of PLABKALI01
Figure 1.67 Screenshot of PLABKALI01: Showing the captured output of the p0f command.

Keep the terminal window open.
Task 7 - Perform Service Probing

Using Nmap, you can find a lot of details about the running services and their version numbers. In this task, you will learn about service probing.

To do this, perform the following steps:
Step 1

Ensure that you are connected to Kali Linux and the terminal window is open.

Clear the screen by entering the following command:

clear

First, let’s find out the hosts that are alive on the network. To do this, type the following command:

nmap -sn 192.168.0.0/24

Figure 1.68 Screenshot of PLABKALI01
Figure 1.68 Screenshot of PLABKALI01: Typing the nmap -sn command in the terminal window.

Step 2

There are eight hosts that are found live on the subnet.

Figure 1.69 Screenshot of PLABKALI01
Figure 1.69 Screenshot of PLABKALI01: Showing the output of the nmap -sn command.

Step 3

Clear the screen by entering the following command:

clear

Next, let’s check the ports open on a system.

nmap 192.168.0.1

Press Enter.

Figure 1.70 Screenshot of PLABKALI01
Figure 1.70 Screenshot of PLABKALI01: Typing the nmap command in the terminal window.

Step 4

Notice the output that displays several open ports on 192.168.0.1.

Figure 1.71 Screenshot of PLABKALI01
Figure 1.71 Screenshot of PLABKALI01: Showing the output of the nmap command.

Step 5

Clear the screen by entering the following command:

clear

Next, let’s check the version of the services on the open ports on 192.168.0.1.

Type the following command:

nmap -sV -O 192.168.0.1

Press Enter.

Figure 1.72 Screenshot of PLABKALI01
Figure 1.72 Screenshot of PLABKALI01: Typing the nmap -sV command in the terminal window.

Step 6

The output displays the version number of most of the services.

Figure 1.73 Screenshot of PLABKALI01
Figure 1.73 Screenshot of PLABKALI01: Showing the output of the nmap -V command.

Step 7

Clear the screen by entering the following command:

clear

Let’s probe the DNS service running on port 53. To do this, type the following command:
Note: The -sV parameter is used to detect the services on the remote host. The -p parameter is used for the port number, which is 53 in this case. The -T parameter is for running the scan at high speed. It assumes that you are on a fast network. The -script parameter allows you to use a pre-defined script bundled with Nmap. The -Pn parameter is meant for a port scan only and does not perform host discovery.

nmap -sV -p 53 -Pn -T5 --host-timeout 2m --script=dns* -v 192.168.0.1

Press Enter.

Figure 1.74 Screenshot of PLABKALI01
Figure 1.74 Screenshot of PLABKALI01: Typing the nmap command with various parameters to probe DNS service in the terminal window.

Step 8

The command runs successfully.

Figure 1.75 Screenshot of PLABKALI01
Figure 1.75 Screenshot of PLABKALI01: Showing the output of the DNS probing.

Keep the terminal window open.
Task 8 - Disabling Ping Sweep

In a normal scenario, Nmap will run the ping sweep to check if the host is live and then performs the port scan. You can disable the ping sweep by using the -Pn parameter, which performs port scan only and does not perform host discovery.

To disable ping sweep, perform the following steps:
Step 1

Ensure that you are connected to Kali Linux and the terminal window is open.

Clear the screen by entering the following command:

clear

To disable the ping sweep, type the following command:

nmap -Pn 192.168.0.1

Press Enter.

Figure 1.76 Screenshot of PLABKALI01
Figure 1.76 Screenshot of PLABKALI01: Typing the nmap -Pn command in the terminal window.

Step 2

Notice that there is no ping sweep performed.

Figure 1.77 Screenshot of PLABKALI01
Figure 1.77 Screenshot of PLABKALI01: Showing the output of the nmap -Pn command.

Keep the terminal window open.
Task 9 - Use the Timing Templates

Nmap also provides timing templates that can be used to speed up or slow down the scans of a system or range of systems. These parameters are as follows:

    -T0: Known as the Paranoid scan. Mainly used for Intrusion Detection System (IDS) evasion
    -T1: Known as the Sneaky scan. Mainly used for IDS evasion
    -T2: Known as the Polite scan. Mainly used when you want to use less bandwidth and target system resources
    -T3: Known as the Normal scan that uses the default speed
    -T4: Known as the Aggressive scan. It speeds up the scan and uses a fairly good amount of bandwidth
    -T5: Known as Insane scan. It really speeds up the scan. It requires a fast network.

To use the timing templates, perform the following steps:
Step 1

Ensure that you are connected to Kali Linux and the terminal window is open.

Clear the screen by entering the following command:

clear

To disable the ping sweep, type the following command:
Alert: This scan will take several hours to complete.

nmap -T1 192.168.0.1

Press Enter.

And continue to the next step.

Figure 1.78 Screenshot of PLABKALI01
Figure 1.78 Screenshot of PLABKALI01: Typing the nmap -T1 command in the terminal window.

Step 2

After waiting for some time, terminate the scan using Ctrl + c. During this time, you can press the Enter key to check current status of the scan.

Notice the output. It still has many hours to go before the scan is completed.

Figure 1.79 Screenshot of PLABKALI01
Figure 1.79 Screenshot of PLABKALI01: Showing the output of the nmap -T1 command.

Step 3

Let’s try the insane scan. Type the following command:

nmap -T5 192.168.0.1

Press Enter.

Figure 1.80 Screenshot of PLABKALI01
Figure 1.80 Screenshot of PLABKALI01: Typing the nmap -T5 command in the terminal window.

Step 4

Notice that the scan took only 2.99 seconds to complete.
Note: In your lab environment, the timings for scan completion may differ.

Figure 1.81 Screenshot of PLABKALI01
Figure 1.81 Screenshot of PLABKALI01: Showing the output of the nmap -T5 command.

Step 5

Clear the screen by entering the following command:

clear

Let’s try a Normal scan with -T3. Type the following command:

nmap -T3 192.168.0.1

Press Enter.

Figure 1.82 Screenshot of PLABKALI01
Figure 1.82 Screenshot of PLABKALI01: Typing the nmap -T3 command in the terminal window.

Step 6

Notice that this scan took slightly more time than the Insane scan. A normal scan finished in little more than four seconds.

Figure 1.83 Screenshot of PLABKALI01
Figure 1.83 Screenshot of PLABKALI01: Showing the output of the nmap -T3 command.

Keep the terminal window open.
Task 10 - Work with Nmap Output Parameters, such as oA, oN, oG, and oX

By default, Nmap generates the output on the screen. You can use various parameters to send the output to different types of files. In this task, you will learn to generate output in different types of files using different parameters.

To work with different output parameters, perform the following steps:
Step 1

Ensure that you are connected to Kali Linux and the terminal window is open.

Clear the screen by entering the following command:

clear

To send the output in the plab.txt file, type the following command:

nmap 192.168.0.1 -oN plab.txt

Press Enter.

Figure 1.84 Screenshot of PLABKALI01
Figure 1.84 Screenshot of PLABKALI01: Typing the nmap -oN command in the terminal window.

Step 2

The output is generated in the plab.txt file.

Figure 1.85 Screenshot of PLABKALI01
Figure 1.85 Screenshot of PLABKALI01: Showing the output of the nmap -oN command.

Step 3

Let’s list the files in the current directory. Type the following

ls -l

Press Enter.

Figure 1.86 Screenshot of PLABKALI01
Figure 1.86 Screenshot of PLABKALI01: Typing the ls -l command in the terminal window.

Step 4

Clear the screen by entering the following command:

clear

Let’s now list the contents of the plab.txt file. Type the following command:

cat plab.txt

Press Enter.

Figure 1.87 Screenshot of PLABKALI01
Figure 1.87 Screenshot of PLABKALI01: Typing the cat plab.txt command in the terminal window.

Step 5

The contents of the plab.txt file are now displayed.

Figure 1.88 Screenshot of PLABKALI01
Figure 1.88 Screenshot of PLABKALI01: Showing the contents of the plab.txt file.

Step 6

Clear the screen by entering the following command:

clear

You can also send the output of the nmap command in an XML file. Type the following command:

nmap 192.168.0.1 -oX plab.xml

Press Enter.

Figure 1.89 Screenshot of PLABKALI01
Figure 1.89 Screenshot of PLABKALI01: Typing the nmap -oX command in the terminal window.

Step 7

The output is sent to the XML file as well as displayed on the screen.

Figure 1.90 Screenshot of PLABKALI01
Figure 1.90 Screenshot of PLABKALI01: Showing the output of the nmap -oX command.

Step 8

Clear the screen by entering the following command:

clear

To view the XML file, type the following command:

cat plab.xml

Press Enter.

Figure 1.91 Screenshot of PLABKALI01
Figure 1.91 Screenshot of PLABKALI01: Typing the cat plab.xml command in the terminal window.

Step 9

The output of the plab.xml file is now displayed on the screen. Notice that the output shown on the screen is now converted in the XML format in the plab.xml file.

Figure 1.92 Screenshot of PLABKALI01
Figure 1.92 Screenshot of PLABKALI01: Showing the output of the cat plab.xml command.

Step 10

Clear the screen by entering the following command:

clear

To generate the grepable output to a file, type the following command:

nmap 192.168.0.1 -oG plab1.txt

Press Enter.

Figure 1.93 Screenshot of PLABKALI01
Figure 1.93 Screenshot of PLABKALI01: Typing the nmap -oG command in the terminal window.

Step 11

The output is sent to the plab1.txt file as well as displayed on the screen.

Figure 1.94 Screenshot of PLABKALI01
Figure 1.94 Screenshot of PLABKALI01: Showing the output of the nmap -oG command.

Step 12

Clear the screen by entering the following command:

clear

To view the grepable file, type the following command:

cat plab1.txt

Press Enter.

Figure 1.95 Screenshot of PLABKALI01
Figure 1.95 Screenshot of PLABKALI01: Typing the cat plab1.txt command in the terminal window.

Step 13

The output of the plab1.txt file is now displayed on the screen. Notice that the output shown on the screen is now converted in the grepable format in the plab1.txt file.

Figure 1.96 Screenshot of PLABKALI01
Figure 1.96 Screenshot of PLABKALI01: Showing the desktop of PLABKALI01.

Step 14

Clear the screen by entering the following command:

clear

Instead of creating individual formats, you can create all three formats at once using a single command. To do this, type the following command:

nmap 192.168.0.1 -oA plabresult

Press Enter.

Figure 1.97 Screenshot of PLABKALI01
Figure 1.97 Screenshot of PLABKALI01: Typing the nmap -oA command in the terminal window.

Step 15

The output of this command is displayed on the screen, and three different files are also created.

Figure 1.98 Screenshot of PLABKALI01
Figure 1.98 Screenshot of PLABKALI01: Showing the output of the nmap -oA command.

Step 16

Clear the screen by entering the following command:

clear

Let’s list the files using the following command:

ls -l

Press Enter. Notice that three files are generated, which are highlighted in the screenshot.
Note: The -oA parameter creates three different extensions: gnmap, nmap, and xml. When you use separate commands, you can use these extensions. The gnmap extension is for grepable output. The nmap extension is for the file that contains the same output as the screen. The xml extension is for the XML output.

Figure 1.99 Screenshot of PLABKALI01
Figure 1.99 Screenshot of PLABKALI01: Typing the ls -l command in the terminal window.

Step 17

Clear the screen by entering the following command:

clear

You can also generate the grepable output on the screen. To do this, type the following command:
Note: Notice that there is a - (dash) after a blank space at the end of the -oG parameter.

nmap 192.168.0.1 -oG -

Press Enter.

Figure 1.100 Screenshot of PLABKALI01
Figure 1.100 Screenshot of PLABKALI01: Typing the nmap -oG - command in the terminal window.

Step 18

The output of this command is displayed on the screen. Notice that the output is in the grepable format.
Note: You can also try out the following commands and view their outputs: nmap 192.168.0.1 -oN - and nmap 192.168.0.1 -oX -

Figure 1.101 Screenshot of PLABKALI01
Figure 1.101 Screenshot of PLABKALI01: Showing the output of the nmap -oG - command.

Lab Assessment
Did you complete all the lab steps? Don't forget to complete the review questions on the next page.
Keep all devices that you have powered on in their current state and proceed to the review section.
3 of 4
7 hours : 46 minutes, PLABWIN10 has changed state and is now On, click the connect button for this device to connect to it's desktop.
7 hours : 46 minutes, PLABWIN810 has changed state and is now On, click the connect button for this device to connect to it's desktop.
7 hours : 46 minutes, PLABDM01 has changed state and is now On, click the connect button for this device to connect to it's desktop.
7 hours : 46 minutes, PLABKALI01 has changed state and is now On
7 hours : 46 minutes, PLABWIN810 has recieved request On
7 hours : 46 minutes, PLABWIN10 has recieved request On
7 hours : 46 minutes, PLABKALI01 has recieved request On
7 hours : 46 minutes, PLABDM01 has recieved request On
7 hours : 47 minutes, PLABWIN10 has changed state and is now Off
7 hours : 47 minutes, PLABWIN10 has recieved request Off
7 hours : 47 minutes, Successfully changed content and lab.
7 hours : 47 minutes, PLABWIN810 is currently in state Off
7 hours : 47 minutes, PLABWIN10 is currently in state On, click the connect button for this device to connect to it's desktop.
7 hours : 47 minutes, PLABKALI01 is currently in state Off
7 hours : 47 minutes, PLABDM01 is currently in state Off
7 hours : 47 minutes, PLABDC01 is currently in state On, click the connect button for this device to connect to it's desktop.
7 hours : 47 minutes, Session start time 11-1:18:43
0 hours : 0 minutes, SignalR has connected via webSockets
PLABDC01
On
PLABDM01
On
PLABKALI01
On
PLABWIN10
On
PLABWIN810
On
Auto logout
57 mins.
PLABKALI01
ULCC01

