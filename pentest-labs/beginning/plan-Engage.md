# this is the first lab in the series. 'Planning an Engagement'. 

Exam Objectives:

	- Explain the importance of planning for an engagement
	- Explain key legal concepts
	- Explain the importance of scoping an engagement properly
	- Explain the key aspects of compliance-based assesments.

#1 what is penetration testing?

a real world simulation of a bad actor trying to exploit any and all vulnerabilities in a clients network.

	Vulnerability assesment vs Penetration testing

- Vuln scanning only finds and lists the vulns with remediation reccomendations.
- Penetration testing not only finds and documents but it also EXPLOITS the 
 vulnerabilities. While documenting proof of concept's (POC) along the way.

	Common PenTest Process
	> CHECK framwork
	> Open Web Application Security Project (OWASP)
	> Open Source Security Testing Methodology Manual
	> Penetration Testing Execution Standard (PTES)
	> NIST SP 800-115

"most of these frameworks and standards are similar in structure, which are shown
  below"

# A. Planning - scoping and documenting of logistics/details

# B. Reconnaissance - gathering information about the system or the organisation
		    - can include passive and active methods of info gathering

#C. Scanning/Enumeration - static/dynamic scanning, starts with vulnscaning(nmap)

#D. Maintaining Access - controlling and maintaining access on compromised systems
		       - gains access to other systems on network.

#E. Covering Tracks - avoids leaving traces/tracks/evidence of the attack and or vul                      nerability.
		    - remove ALL traces of the attack

#F. Analysis - gathers information
	     - identifies the root cause of the detected vulnerabilities
	     - Provides mitagation recommendations

#G. Reporting - provides detailed inputs from the testing and analysis phases
	      - includes info about vulns sensitive data exposure, duration of acces                s on the systems and mitigation methods to counter the vulns.



#2 Use serpico to generate a penetration report.

( this is where you make your money!! take great notes! as if there were any other kind.. haha)


#A. head to Serpico log in using 'USERNAME=administrator' 'PASSWORD=Passw0rd'

	> select Consultant Information
	> list report templates
	> choose from the pre configured options or create your own

#B. key audience members for your presentation on your findings

	> Senior management
	> IT managers
	> Security teams
	> Web Developers
	> Web server administrator
 " just like in comedy, we scout the audience. easy stuff. :) "


#3. Different types of resource documents..

	> Webt Services Description Language (WSDL)
          and Web Application Description Language(WADL)
	> These are XML (extensible markup language. markup language:
          a set of codes || tags, that describes the text in a digital document)

	#vocab: SOAP (Simple Access Protocol)
		- a network platform used in a web service to exchange or 
		  communicate data between two different machines on a network.

		Software Developement Kit (SDK)
		- there are open-source and commercial SDKs available.
		  an organization can also creat a custom SDK to develpoe an Applica		      tion.
		- the pentester should have access to the SDK docs to perform a test		      on the applications.

#A. Swagger Document

	> this document provides information about the REST API and how it works.
	
	> this info is useful to the pentester as to how the API can be tested


#B. XML Schema Definition (XSD) file

	> this document defines the XML elements and their attributes that appear in          an XML document.
	> it also defines the relationship between the elements and the data that wi          ll be stored with in them.

#4. Budget Requirements

	> huge impact on the scope of the test.
	> both parties involced must come to an agreement to define the scope of ser          vices in a defined budget.
	> just like anything and evertyhing else. the client will want the most amount of work for the least amount of money. and of course you have us(service provider) want to maximize profit while minimizing the effort and time. its a balance.
	> budget could also be defined in a number of hours for the internal teams, which would need allocation of time to conduct the penetration test.
	> you bill according to the number of team members you have working on it/ s	      cope of work/ and total time spent.
	> 'Time and Materials'
note: BOTH PARTIES MUST AGREE ON EVERYTHING BEFORE ANY TESTING TAKES PLACE!
      PERIOD. NO ACCEPTIONS. 

#5. Technical Constraints

	> These constraints MUST be mentioned in the penetration testing plan.
	> ex: - the pentest software you need is too expensive for one test
	      - performing on a live web server can impact the performance of the te		    st
	      - maybe the server is too old/ outdated to be able to handle a penetra                tion test

#6. Explain Rules of Engagement, Contract Types, and Scoping and Engagement

	here are several types of contractual agreements that are available

	Penetration testing agreement- This is an agreement between the penetration         tester and the company that requseted the penetration test. contains
	scope of the test. which parts of the network to test, and which to avoid et        c. 

	Statement of work (SOW)- SOW is specific to an assignment that you may take 	    up as a pentester. SOW is created based on a set of tasks that are part of t        he Master Service Agreement


	Non-disclosure agreement(NDA)- A non-disclosure agreement is signed between         both parties. each party is clearly defined. and it decrees that whatever
	confidential information you see must never be shared with a third-party
	else undergo a flogging for such behavior. then execution by firering squad.        or stoned to death, i think are some of the modern day punishments. lol

#7. The Rules of Engagement

	- this document defines how the testing will be conducted. Before
	  structuring this doc we (the pentester) need to determine which type
	  of penetration test needed.

#A. Timeline- defines the duration of the test, time at which it's meant	                  to take place. 
	- you may not want to perform tests during peak hours of opperations
	- OR maybe you do. could be a stress test. just depends.
	- typically though you want to perform the test when there is no load
	  load on the server.

#B. Targets
	- TARGETS='clearly defined' 
	- section includes:
	  > Locataions
	  > Systems
	  > Applications
	  > Third-party service providers(if any), such as internet
            service providers (ISPs), Software as a Service (Saas) providers
	- any type of inclusions and exclusions must also be defined in this section

#C. Data Handling
	- Data handling requirements must be included in this section, which should
	  clearly state how the confidential(all) data must be handled during the pe	      netration testing.
	- it also needs to specify what is to be done with the information obtained
          during the test. (destroy all information/ give it to them)

#D. Resources
	-  must contain the resources that are going to participate in the pentestin           g

#E. Target behavior
	- this section must include the behavior output form the pentest.
	- i.e. what should the pentester be expecting the firewall to do when 
	  you perform an attack on it. 
	it should block me and report the port as down but it's still showing the
	port open and available for use...
	

#F. Communication Methods 
	- defines the method(s) of communication and it's timeline.
	- depending upon the length of engagement, communincation timeline can be de	      fined.
	> a month long test/ weekly communiccation should work.
	> if test is no longer then a week then you could probably just submit at 
	  the end of the week and vbe straight.

#G. Single Point of Contact (SPOC)
	- there is a pentester spoc
	- there is a client spoc
	> if any issue arises at all. these two people need to connect immediately
	  or as soon as humanly possible

#H Escalation Channel
	- must be defined in the Ruled of Engagement Doc.
	> an escalation could be finding a critical vuln requiring immediate
	  attention. 
	> there must be a decision maker in this channel. period. that is all.
	- the pentester should know whom to approach in case of a red alert


#I. Legal Concerns
	- any legal concern related to penetration testing must be
	  CLEARLY DEFINED. no exceptions, questions, or choice.
	
# Disclaimers
	- all of my penetration testing plans will include a 'point-in-time' assesme          nt clause, which state that penetration testing and its results have a 
	  limited lifecylce. 

	- all test are performed on a specific network, servers, and application
          configuration. even the smallest change in these settings could nullify
	  the results of the penetration test.

	- comprehensiveness clause: includes times frame for validity fo the result

	- another disclaimer can state each and every single vuln in the network/
          servers, or applications that may be found. 



# Basic guidelines for Planning a penetration testing

Before proceeding with the penetration testing, you should consider the following..

	- Understand your audience
	- ID resources for penetration testing- have them ready BEFORE proceeding
	- id the technical constraint beforehand: restricted access to the systems
	  or conducting a test against a critical production server
	- defined/ understand the rules of engagement.
	- Identify Disclaimers


#10. SOW, MSA, and NDA 

Maseter Service Agreement
> typically used when two parties intend to work for a long time or over
  muliple projects.
> the agreement broadly lists the work to be done over a period of time
> the total cost of the work is defined. (it is created BEFORE a SOW is created

Statement of Work(SOW)
 details the following information...
> purpose of the work being assigned to the pentester
> the scope of the assignment
> tasks to be performed as part of the scope
> milestones for various phases of the assignment
> the expected deliverables at the end of the assignment
> the timeline or  schedule for the assignment
> total amount to be paid to the pentester

NOTE: an organization mat include or delete some of these mentioned points

Non-disclosure agreement(NDA)

> a non-disclosure agreement is signed between BOTH parties, where each party
is defined clearly.
> it decrees that the confidential info must not be shared with a third-party. at all. ever.

	- Definition of Confidential Info
	- Purpose of NDA
	- no Disclosure clause mentioning that the recipient should protect the info	      as their own
	- duration of aggreement
	- Severability
	- exclusions from the confidential info	


#12 Scope Creep

	When you are met with a decision that asks for you to go outside the scope
        (typically meaning you find something that requires extra work)
	you can choose to stick with the original scope || provide a new price to th	    e client.



#13. Scheduling a Penetration test
	
> A clear time line for a test MUST be defined. I want this part more clear
  than any other.

> should also include, for one or more targets when the testing needs to
  take place
	- ex: on a live public-facing webserver, it would be a poor idea to test dur              ing the day when the load on the servers is high.
	- if we knock the webserver(s) over it wont be able to prrovide service to
          legit users
	- Scheduling is a critical task and must be thought through



#14 Legal restrictions - local and national Government

> There are certain legal restrictions that can impact penetration testing

    - Export Restrictions: Certain export restrictions may restrict the pentester
      to obtain a particular software or service. For example, the United States
      does not permit the export of certain software or services to certain
      countries.

    - similar to the USA, other countries may also impose the same restrictions

> Local and National Governmental Restrictions: the local or national government
  restrictions may prevent the pentester from performing penetration testing.

    - ex: certain activities like Denial of Service (DoS) might be prohibited
          to be performed as part of a penetration test in a production environment

> Corporate Policies: mainly medium and large organizations have corporate security           policies that can include a penetration testing policy. if this                     exists within the organization, it must be shared with the pentester
	  to understand that what should or should not be done.

	  components found within these docs can impact the penetration test
	
	- ex: an organization due to a compliance assesment is likely to define 
  	      his/her penetration testing docs. The existing documents can be re-use		  d and align the penetration testing to the compliance assessment.

> Scopes in an Engagement

- scoping defines the boundaries of engagement. both parties agreee on the scope and the tasks that are within the scope. Anything outside of the scope is considered to be out of the scope . Later, the scope becomes the basis for creating a Statement o f Work (SoW)

 While scoping you must consider the following...

	- Types of test to be peroformed
	- Targets - internal or external
	- Targets - onsite or offsite
	- Hosted internally or externally to a third-party provider
	- Hosted as infrastructure or cloud, such as Saas
	- Databases

> this is not an exhaustive list but some of the ket pointers to be considered when   scoping a pentest.

> the larger the scope, the longer it takes, the more it costs.

> therefore, if the organization is working with a fixed budget, they may want to
  limit the scope to just a few areas/ targets.

 
#15 Discuss End Goals and Deliverables

> Before the scoping can be defined, the organization must clearly state and identif  y the reason for the penetration test.

> ex: is the test required to meet compliance standards || simply to id vulns and ex      ploit in network security

> there are numerous reasons to perform a penetration test but whatever it is
  IT MUST BE CLEARLY defined.

> the end goal is to find the vulnerabilities, exploit them, and then close them
  as required.

> The penetration testing report is the final deliverable. It should highlight
  the follwing:
	- Type of test performed
	- Vulnerabilities that are Identified
	- Vulns that are exploited
	- Mitigation suggestions

NOTE: if also needs to include the Executive Summary section that should explain
      the risk and business impact of the security concerns as discovered in penetra      tion testing. this section should be non-technical and in simple English.

      needless to state that the report should be actionable and should have
      included items that need to be xlosed and the penetration test.

#16. Different types of testing stratagies




''

after the scope of the test is defined, it needs to be decided on
the type of penetration testing to be performed. 3 types


''

 black box

 white box

 grey box


#A Black Box aka (zero knowledge penetration testing)

> of the three this the most realistic.
> the tester has nothing but a set of ip ranges
> these take longer of course but also simulate the msot realistic
  live scenario.

#B White Box aka ( Full knowledge penetration testing)

> complete opposite the black box
> the pentester will have all of the information needed to 
  perform the penetration test
	- network Diagrams
	- list of systems with their IP address
	- IP ranges
	- User credentials to log on to the systems

> takes less time 
> doesn't allows provide accurate results because it 
  does not visualize the attacks as an external attacker would.


#C. Gray Box 

> mix of the white box and black box. surprise!
> tester has limited information
> usually no diagrams or log in credentials

	- ex: you may share the application name and it's IP
	      address with the tester but not provide the app
	      licationname and it's IP address but not the 
	      version or the services that are running.
	

#17. Explain Target Selection and Threat Actors
''
when defining the scope of the penetration test you need to consider the types of targets that need to be involved. there are multiple types 
of targets, which are as follows...

''


#A. Internal

> targets are located within the organization 
> an insider attack is coomon on the internal targets
> external malicious attackers only needs access to the internal
  nework, then use priv esc to go to town.
> external attackers will use phishing social engineering to gain
  access to the internal network.

#B On-site

> this is where the attack is being conducted
> depending on the number of security controls,
  the attacks may be prevented on the on-site targets.
> if the site is large enough, then there will multiple
  entry points for the attacker to gain access to the targets.

#C. Off-site
> not located within the organization premises to which it provides services

> ex: targets may be located at a branch office using remote connect
      ivity. if there are note enough security controls at the remote
      offices, then they could be the medium for a backdoor into 
      the head office.

#D. External

> not present within the organization and are located on the internet
> examples could be Websites or Webb applications

#E First-party hosted

> hosted within the organization and can be an easy target
> 1 of the most common attacks could be a zero-day exploit
> zero-day attacks exploit an unknown vuln.
> third-party target can be difficult to penetrate, specifically
  if they are with a large organizatio, which can have multiple layers
  of security controls. Smaller organizations' targets can be easy
  to penetrate.

#F. Third-party hosted

> either hosted at a vendor site || by a partner organiztion
> can be tough to penetrate if apart of a large organization

#G. Physical

> piggy backing: waiting for someone to clear a secure area and then a    second person quickly lets themself in right after without having to   use credentials

> shoulder surfing: looking over someones shoulder while they type
  in their phone or their computer

> keyloggers are another thing to check for: they capture the keystroke  s and send them to a remote entity who controls the logger.

#H. Users

> pentesters can also target users.
> they are the easiest to target
> they typically will fall prey to social engineering attacks

#I. SSID's

> wireless networks are accessed using an SSID, which is the name of
  of the wireless network. An SSID may be visable or hidden.

> you can use tools like 'Kismet' to find hidden SSID's

> when an SSID of the network is known, the pentester, in the simplest
  means, can capture the wireless traffic and find the SSID fo the wire  less network and MAC assress of the access point. Various types of wi  reless attacks can be performed by the pentester

> ex: cloning the access point using a tools named airbase-ng

#J. Applications

> can be a primary target during a pentest

> several web applications have E-commerce capabilities
  which must be tested and secured appropriately if vulnerabilities
  are found

> even if the website does not have e-commerce capability but runs
  the user context, then it is a good target to penetrate and perform
  RCE (remote code execution)

#K Types of Threat Actors
''
threat actors are any entity behind a threat, which is a potential
danger to an asset. a threat actor can be largely categorized into
three categories...

''
> internal threat (e.g., a rogue employee)
> external threat (e.g., a criminal gang)
> natural threat (e.g., hurricane or tsunami)

Threat actors look for vulnerabilities, which are weaknesses
that can be exploited. when a vuln is present in the network, server, or application, there is a risk that the threat actor may exploit it.

#L Hackers

> three tyoes of hackers: black hat, gray hat, and white hat.
	
	- black hat hackers break into systems w/ malicious intent		 usually highered or contracted by organizations to evalute
	  there security parameters. 

	- grey hat hackers: break into systems with out permission
	  they want to demonstrate their skills by stealing or 
	  destroying data. however, they intent is not malicious

	> grey hat hackers' actions are ILLEGAL because all of their
	  actions are conducted with out permission.

#M Script Kiddies
''

a script kiddie is someone who does not have the expertise of a hacker
but relies on ready-made tools as they cannot write their own code.
due to lack of expertise, their attacks are not sophisticated.

''

#N Hacktivists

> these are threat actors who are hackers with a specific mission
  in mind. 

> could be political or social

> dont care about money

> mostly use Ddos

> work with other hackers

#O Nation State/State Sponsored

'' 
These threat actors are well-funded and well-organized cyber espionage
entities that commit their activities with the backing of governments
or similarly large entities

State-sponsored attackers typically focus on infiltrating larger
organizations with the intent to steal massive amounts of mission-critical and other sensitive data.

''

#P Insider Threats

>  these threat actors are internal to the ORG and can carry out
   malicious activity intentionally or unintentionally
>  ex: they might hand out sensitive/confidential info to another
       threat actor who wants to misuse the information.

> very hard to detect because they are in the system

> they would have access to the data along with knowlege of internal
  ops and processes.

> since they are inside the network, their actions are difficult to track by tools like a firewall






































































































































































































































































 
	





















































